color="red") +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Lethbridge") +
theme(aspect.ratio = 1)
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
scott_increase <- site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-15,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=scott_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1, size=3) +
geom_segment(data=scott_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0, size=3) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Scott") +
theme(aspect.ratio = 1)
swiftcurrentnew_increase <- site_data_all_joined %>%
filter(location_name == "Swift Current New") %>%
group_by_all() %>%
ungroup(field_name, soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true) %>%
summarise_all(first)
site_data_all_joined %>%
filter(location_name == "Swift Current New") %>%
group_by_all() %>%
ungroup(field_name, soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=swiftcurrentnew_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentnew_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=swiftcurrentnew_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentnew_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0) +
geom_point() +
geom_point(data=swiftcurrentnew_increase,aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Swift Current New") +
theme(aspect.ratio = 1)
swiftcurrentold_increase <- site_data_all_joined %>%
filter(location_name == "Swift Current Old") %>%
group_by_all() %>%
ungroup(field_name, soil_depth) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+")) %>%
summarise_all(first)
site_data_all_joined %>%
filter(location_name == "Swift Current Old") %>%
group_by_all() %>%
ungroup(field_name, soil_depth) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=swiftcurrentold_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentold_increase, aes(hjust=ifelse(first_soc_year < 2000, -0.1, 1.1), x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red") +
geom_point() +
geom_point(data=swiftcurrentold_increase,aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Swift Current Old") +
theme(aspect.ratio = 1)
site_data_all
site_data_all$soil_depth_max_cm
View(site_data_all)
bb <- site_data_all %>%
select(location_name, year_name, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year, flag)
View(bb)
initialc_all
bb <- site_data_all %>%
select(location_name, year_name, treatment_name, flag, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(location_name=="Ellerslie")
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, flag, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(location_name=="Ellerslie")
View(bb)
site_data_all <- readr::read_csv(here("data/all_experiments_dummy.csv"))
site_data_all <- readr::read_csv(here("data/all_experiments_dummy.csv"))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, flag, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(location_name=="Ellerslie")
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
```
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie")
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste0(soc_tha,treatment_number))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste0(soc_tha,filter(., treatment_number==1)$treatment_number))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste0(location_name,filter(., treatment_number==1)$treatment_number))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste0(treatment_name,filter(., treatment_number==1)$treatment_number))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste0(treatment_name,filter(., treatment_number==1)$soc_tha))
View(bb)
bb
grps <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
filter(treatment_number == 1)
View(grps)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,grps$soc_tha))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,filter(grps,year_name==year_name)$soc_tha))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,filter(grps,year==year_name)$soc_tha))
grps <- site_data_all %>%
select(location_name, year=year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
filter(treatment_number == 1)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,filter(grps,year==year_name)$soc_tha))
filter(grps,year==1983)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
#group_by(year_name) %>%
mutate(bb = paste(treatment_name,filter(grps,year==year_name)$soc_tha))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,filter(grps,year==year_name)$soc_tha))
filter(grps,year==year_name)$soc_tha
filter(grps,year==1983)$soc_tha
bb
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,.$treatment_number))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(bb = paste(treatment_name,.$treatment_name))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(gob = paste(treatment_name,.$treatment_name))
bb$treatment_name
filter(bb, treatment_number==1)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(gob = paste(treatment_name, filter(filter(., treatment_number==1), year_name==year_name ) ))
bb$year_name
filter(filter(., treatment_number==1), year_name==year_name )
filter(filter(bb, treatment_number==1), year_name==year_name )
filter(filter(bb, treatment_number==1), year_name==1983 )
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(gob = paste(treatment_name, filter(filter(., treatment_number==1), year_name==year_name )$treatment_name ))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(gob = paste(treatment_name, filter(filter(., treatment_number==1), year_name==year_name )$soc_tha ))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(gob = paste(treatment_name, filter(filter(., year_name==year_name),  treatment_number==1)$soc_tha ))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name)
bb
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
group_split()
View(bb[[1]])
mutate(gob = paste(treatment_name, filter(.,  treatment_number==1)$soc_tha )
mutate(gob = paste(treatment_name, filter(.,  treatment_number==1)$soc_tha )
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
#group_split()
mutate(gob = paste(treatment_name, filter(.,  treatment_number==1)$soc_tha ))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
#group_split()
mutate(gob = paste(treatment_name, filter(cur_data(),  treatment_number==1)$soc_tha ))
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(control_soc = filter(cur_data(),  treatment_number==1)$soc_tha )
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Ellerslie") %>%
group_by(year_name) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name, soil_depth) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
site_data_all <- readr::read_csv(here("data/all_experiments_dummy.csv")) %>%
mutate(soil_depth = paste0(soil_depth_min_cm,"-",soil_depth_max_cm))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name, soil_depth) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
site_data_all$soil_depth
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soil_depth,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name, soil_depth) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soil_depth,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name, soil_depth)
View(bb)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soil_depth,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name, soil_depth, replication_number) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soil_depth,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
group_by(year_name, soil_depth, replication_number)
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soil_depth,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
filter(replication_number==1) %>%
group_by(year_name, soil_depth, replication_number) %>%
mutate(soc_tha_control = filter(cur_data(),  treatment_number==1)$soc_tha,
soc_tha_10cm_control = soc_tha_control*(10/(soil_depth_max_cm - soil_depth_min_cm)))
bb <- site_data_all %>%
select(location_name, year_name, treatment_number, treatment_name, replication_number, soil_depth,
soc_tha, soil_depth_min_cm, soil_depth_max_cm, soc_tha_30cm,
initial_soc_tha, initial_soc_year) %>%
filter(!is.na(soc_tha)) %>%
filter(location_name=="Lethbridge") %>%
filter(replication_number==1) %>%
group_by(year_name, soil_depth, replication_number)
View(bb)
