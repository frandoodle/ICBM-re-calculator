ungroup(field_name, soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+")) %>%
summarise_all(first)
site_data_all_joined %>%
filter(location_name == "Swift Current New") %>%
group_by_all() %>%
ungroup(field_name, soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=swiftcurrentnew_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentnew_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_point() +
geom_point(data=swiftcurrentnew_increase,aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Swift Current New") +
theme(aspect.ratio = 1)
swiftcurrentold_increase <- site_data_all_joined %>%
filter(location_name == "Swift Current Old") %>%
group_by_all() %>%
ungroup(field_name, soil_depth) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+")) %>%
summarise_all(first)
site_data_all_joined %>%
filter(location_name == "Swift Current Old") %>%
group_by_all() %>%
ungroup(field_name, soil_depth) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=swiftcurrentold_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentold_increase, aes(hjust=ifelse(first_soc_year < 2000, -0.1, 1.1), x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red") +
geom_point() +
geom_point(data=swiftcurrentold_increase,aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Swift Current Old") +
theme(aspect.ratio = 1)
ottawa_increase
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year))
ottawa_increase
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=recommended_initial_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_text(data=ottawa_increase, aes(x=recommended_initial_soc_year, y=first_soc, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_text(data=ottawa_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_text(data=ottawa_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=-1) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
ottawa_increase <- site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Ottawa") %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_segment(data=ottawa_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ottawa_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_text(data=ottawa_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Ottawa") +
theme(aspect.ratio = 1)
scott_increase <- site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=scott_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=scott_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Scott") +
theme(aspect.ratio = 1)
scott_increase <- site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-15,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=scott_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=scott_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Scott") +
theme(aspect.ratio = 1)
swiftcurrentnew_increase <- site_data_all_joined %>%
filter(location_name == "Swift Current New") %>%
group_by_all() %>%
ungroup(field_name, soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true) %>%
summarise_all(first)
site_data_all_joined %>%
filter(location_name == "Swift Current New") %>%
group_by_all() %>%
ungroup(field_name, soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=swiftcurrentnew_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentnew_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=swiftcurrentnew_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=swiftcurrentnew_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0) +
geom_point() +
geom_point(data=swiftcurrentnew_increase,aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Swift Current New") +
theme(aspect.ratio = 1)
scott_increase <- site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-15,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=scott_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=scott_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0, size=1) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Scott") +
theme(aspect.ratio = 1)
scott_increase <- site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_tha_30cm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_true, initial_soc_year) %>%
unique %>%
mutate(increase = first_soc - initial_true,
increase_per_year = increase / (first_soc_year - initial_soc_year),
fraction_increase = increase/initial_true,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year-15,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_true)
site_data_all_joined %>%
filter(location_name == "Scott") %>%
group_by_all() %>%
ungroup(soil_depth, plot_id) %>%
summarise_all(mean) %>%
ungroup(replication_number) %>%
summarise_all(mean) %>%
ggplot(aes(x=year_name, y=soc_tha_30cm)) +
geom_segment(data=scott_increase, aes(y=initial_true, x=initial_soc_year, yend=first_soc, xend=first_soc_year), color="red",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=first_soc_year, y=first_soc, label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="red", hjust=-0.1) +
geom_segment(data=scott_increase, aes(y=initial_true, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="blue",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=scott_increase, aes(x=recommended_initial_soc_year, y=initial_true, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="blue", hjust=-0.1, vjust=0, size=3) +
geom_point() +
geom_point(aes(y=initial_true, x=initial_soc_year), color="red") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle("Scott") +
theme(aspect.ratio = 1)
