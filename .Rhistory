site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.5) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .3))
}
make_normal_plot("Ellerslie")
make_arrow_plot <- function(location)
{
ellerslie_increase <- site_data_corrected %>%
filter(location_name == location) %>%
filter(!(treatment_name %in% c("NT", "CT", "NT", "NA"))) %>%
group_by_all() %>%
summarise_all(mean) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_30cm_dsm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_dsm, initial_soc_year_dsm) %>%
unique %>%
mutate(increase = first_soc - initial_dsm,
increase_per_year = increase / (first_soc_year - initial_soc_year_dsm),
fraction_increase = increase/initial_dsm,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year_dsm),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year_dsm-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_dsm)
site_data_corrected %>%
filter(location_name == location) %>%
filter(!(treatment_name %in% c("NT", "CT", "NT", "NA"))) %>%
# Get mean values between replicates and soil depth measurements. Lethbridge requires a particularly difficult grouping scheme
group_by_all() %>%
summarise_all(mean) %>%
summarise_all(mean) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_segment(data=ellerslie_increase, aes(y=initial_dsm, x=initial_soc_year_dsm, yend=first_soc, xend=first_soc_year), color="green",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ellerslie_increase, aes(x=first_soc_year, y=first_soc, hjust=ifelse(first_soc_year < 1990, -0.1, 1.1), label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="green") +
geom_segment(data=ellerslie_increase, aes(y=initial_dsm, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="black",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ellerslie_increase, aes(x=recommended_initial_soc_year, y=initial_dsm, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="black", hjust=-0.1, vjust=0) +
geom_point(aes(y=soc, color=soc_method), alpha=0.5) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .3))
}
make_arrow_plot("Harrow")
make_normal_plot("Lethbridge")
location <- "Lethbridge"
site_data_corrected %>%
filter(location_name == location)
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.5) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .3))
site_data_corrected %>%
filter(location_name == location) %>%
filter(treatment_name == "N0P0")
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.5) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .3))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.1) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .3))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .3))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = alpha(c("blue", "red"), .1))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
make_arrow_plot <- function(location)
{
ellerslie_increase <- site_data_corrected %>%
filter(location_name == location) %>%
filter(!(treatment_name %in% c("NT", "CT", "NT", "NA"))) %>%
group_by_all() %>%
summarise_all(mean) %>%
summarise_all(mean) %>%
group_by(treatment_name) %>%
mutate(first_soc = first(soc_30cm_dsm),
first_soc_year = first(year_name)) %>%
select(treatment_name, first_soc, first_soc_year, initial_dsm, initial_soc_year_dsm) %>%
unique %>%
mutate(increase = first_soc - initial_dsm,
increase_per_year = increase / (first_soc_year - initial_soc_year_dsm),
fraction_increase = increase/initial_dsm,
fraction_increase_per_year = fraction_increase / (first_soc_year - initial_soc_year_dsm),
sign = ifelse(fraction_increase_per_year<0, "-", "+"),
recommended_initial_soc_year = initial_soc_year_dsm-10,
recommended_increase_per_year = increase / (first_soc_year - recommended_initial_soc_year),
recommended_fraction_increase_per_year = recommended_increase_per_year/initial_dsm)
site_data_corrected %>%
filter(location_name == location) %>%
filter(!(treatment_name %in% c("NT", "CT", "NT", "NA"))) %>%
# Get mean values between replicates and soil depth measurements. Lethbridge requires a particularly difficult grouping scheme
group_by_all() %>%
summarise_all(mean) %>%
summarise_all(mean) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_segment(data=ellerslie_increase, aes(y=initial_dsm, x=initial_soc_year_dsm, yend=first_soc, xend=first_soc_year), color="green",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ellerslie_increase, aes(x=first_soc_year, y=first_soc, hjust=ifelse(first_soc_year < 1990, -0.1, 1.1), label=paste0(sign,round(increase_per_year, 2)," Mg/ha/yr\n",sign,round(fraction_increase_per_year,2)*100, "%/yr")),
color="green") +
geom_segment(data=ellerslie_increase, aes(y=initial_dsm, x=recommended_initial_soc_year, yend=first_soc, xend=first_soc_year), color="black",
arrow = arrow(length = unit(0.1, "inches"))) +
geom_text(data=ellerslie_increase, aes(x=recommended_initial_soc_year, y=initial_dsm, label=paste0(sign,round(recommended_increase_per_year, 2)," Mg/ha/yr\n",sign,round(recommended_fraction_increase_per_year,2)*100, "%/yr")),
color="black", hjust=-0.1, vjust=0) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
}
make_normal_plot <- function(location) {
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
}
make_normal_plot("Ellerslie")
make_arrow_plot("Harrow")
make_normal_plot("Lethbridge")
make_arrow_plot("Ottawa")
make_normal_plot("Ottawa")
make_normal_plot("Scott")
make_normal_plot("Scott")
make_normal_plot <- function(location) {
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="black") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red")) +
theme(legend.position = "bottom")
}
make_normal_plot("Ellerslie")
make_normal_plot <- function(location) {
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dsm"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="black") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
}
make_normal_plot("Swift Current New")
make_normal_plot("Swift Current Old")
make_normal_plot("Harrow")
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
site_data_corrected <- site_data_corrected %>% mutate(soc_30cm_dynamic = soc_30cm_dsm)
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
ggtitle(location) +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)", color = "Legend Title\n") +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth correction method", shape = "Initial C estimation method") +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("1", "2"), values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("Dynamic", "Naive"), values = c("square", "triangle"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(values = c("square", "triangle"))
site_data_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
bb <- site_data_corrected %>%
filter(!(treatment_name %in% c("NT", "CT", "NT", "NA"))) %>%
group_by_all() %>%
summarise_all(mean) %>%
summarise_all(mean) %>%
group_by(location_name, treatment_name) %>%
mutate(dsm_first_soc = first(soc_30cm_dynamic),
dsm_first_soc_year = initial_soc_year_dsm,
dataset_first_soc = first(soc_30cm_naive),
dataset_first_soc_year = initial_soc_year,
`DSM + Dynamic` = initial_dsm - dsm_first_soc,
`CMods + Naive` = initial_cmods - dataset_first_soc) %>%
pivot_longer(c("DSM + Dynamic", "CMods + Naive"), names_to="method", values_to="diff") %>%
select(location_name, treatment_name, method, diff) %>%
group_by(location_name, method) %>%
summarise(diff = mean(diff))
ggplot(bb, aes(x=location_name, y=diff, fill=method)) +
geom_col(position = "dodge") +
ylab("[Initial estimate] - \n[First measured SOC] (Mg C/ha)") +
theme_bw() +
theme(axis.text.x = element_text(angle = -90))
site_data_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.4) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="red") +
theme_bw() +
facet_wrap(vars(location_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
theme(aspect.ratio = 1)
site_data_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.4) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="red") +
theme_bw() +
facet_wrap(vars(location_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
site_data_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.4) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(location_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
site_data_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(location_name)) +
ylab("SOC (Mg/ha)") +
xlab("Year") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
site_data_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(location_name)) +
labs(x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
make_normal_plot("Swift Current New")
make_normal_plot("Swift Current New")
gabba <- site_data_corrected %>%
filter(location_name == "Swift Current New")
View(gabba)
babba <- 	site_data_all %>%
filter(location_name == "Swift Current New")
View(babba)
babba$soil_depth
unique(babba$soil_depth)
trabba <- babba %>% filter(treatment_name == "W")
View(trabba)
nrabba <- gabba %>% filter(treatment_name == "W")
View(nrabba)
