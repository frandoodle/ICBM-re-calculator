mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(fifteenthirty$year[fifteenthirty$year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(fifteenthirty$year[fifteenthirty$year < year_name]))) %>%
pull(soc_tha)
)),
0)) %>%
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference,
soc_tha_lowest_depth)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
fifteenthirty
fifteenthirty %>%
filter(id == 7,
trmt == "W") %>%
filter(year == min(unique(fifteenthirty$year[fifteenthirty$year > 1990]))) %>%
pull(soc_tha)
fifteenthirty
fifteenthirty %>%
filter(id == 7,
trmt == "W")
fifteenthirty %>%
filter(id == 7,
trmt == "W") %>%
filter(year == min(unique(fifteenthirty$year[fifteenthirty$year > 1990])))
pull(soc_tha)
unique(fifteenthirty$year[fifteenthirty$year > 1990]))
unique(fifteenthirty$year[fifteenthirty$year > 1990])
fifteenthirty %>%
filter(id == 7,
trmt == "W") %>%
filter(year == min(unique(year[year > 1990])))
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
)),
0)) %>%
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference,
soc_tha_lowest_depth)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
fifteenthirty %>%
filter(id == 7,
trmt == "(CHF)-WW-WW") %>%
filter(year == min(unique(year[year > 1990])))
fifteenthirty %>%
filter(id == 7,
trmt == "(CHF)-WW-WW") %>%
filter(year == min(unique(year[year < 1990])))
fifteenthirty %>%
filter(id == 7,
trmt == "(CHF)-WW-WW") %>%
filter(year == min(unique(year[year < 1993])))
fifteenthirty %>%
filter(id == 7,
trmt == "(CHF)-WW-WW") %>%
filter(year == min(unique(year[year > 1993])))
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
), na.rm=TRUE),
0)) %>%
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference,
soc_tha_lowest_depth)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
fifteenthirty %>%
filter(id == 7,
trmt == "(CHF)-WW-WW") %>%
filter(year == min(unique(year[year < 1990])))
fifteenthirty %>%
filter(id == 7,
trmt == "(CHF)-WW-WW") %>%
filter(year == min(unique(year[year > 1993])))
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-(WW)-WW") %>%
filter(year == min(unique(year[year > 1993])))
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-(WW)-WW") %>%
filter(year == min(unique(year[year < 1993])))
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-WW-(WW)") %>%
filter(year == min(unique(year[year < 1993])))
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-WW-(WW)") %>%
filter(year == min(unique(year[year > 1993])))
mean(
c(
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-WW-(WW)") %>%
filter(year == min(unique(year[year > 1993]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-WW-(WW)") %>%
filter(year == min(unique(year[year < 1993]))) %>%
pull(soc_tha)
), na.rm=TRUE)
mean(
c(
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-WW-(WW)") %>%
filter(year == min(unique(year[year > 1990]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == 7,
trmt == "CHF-WW-(WW)") %>%
filter(year == min(unique(year[year < 1990]))) %>%
pull(soc_tha)
), na.rm=TRUE)
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(max(cur_data()$lowest_depth == 30 &&
lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
)),
0))) %>%
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference,
soc_tha_lowest_depth)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(max(cur_data()$lowest_depth) == 30 &&
lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
)),
0)) %>%
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference,
soc_tha_lowest_depth)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(max(cur_data()$lowest_depth) == 30 &
lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
)),
0)) %>%
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference,
soc_tha_lowest_depth)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
library(ggplot2)
library(dplyr)
library(here)
library(stringr)
library(tidyr)
dir.create(tempdir()) #This fixes a bug if the temporary directory is not found
here::i_am("qc_initialc.rmd")
source(here("r/make_depth_groups.r"))
site_data_1_all <- readr::read_csv(here("data/lte_master_beta_dec02.csv")) %>%
mutate(soil_depth = paste0(soil_depth_min_cm,"-",soil_depth_max_cm))
initialc_dsm <- readr::read_csv(here("data/lte_soc_30_cm_dsm.csv")) %>%
mutate(location_name = location_n) %>%
select(location_name, initial_dsm = `Can_SOC30 (Mg ha-1)`) %>%
unique
initialc_cmods <- readr::read_csv(here("data/ExptSiteList.csv")) %>%
select(location_name, initial_cmods = init_soc) %>%
unique
site_data_2_depth_groups <- site_data_1_all %>%
full_join(initialc_dsm, by=c("location_name")) %>%
full_join(initialc_cmods, by="location_name") %>%
select(Exp_ID, location_name, treatment_number,treatment_name, year_name, replication_number, soil_depth, soil_depth_min_cm, soil_depth_max_cm,
initial_soc_year,
initial_dataset = initial_soc_tha,
soc_tha) %>%
filter(!is.na(soc_tha)) %>%
# Get the mean for field_name, replication_number, and block
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name, soil_depth_min_cm, soil_depth_max_cm, initial_soc_year) %>%
summarise(across(initial_dataset:soc_tha, mean)) %>%
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name) %>%
group_split() %>%
purrr::map(~make_depth_groups(.)) %>%
bind_rows
site_data_3_joined <- site_data_2_depth_groups %>%
left_join(initialc_dsm, by=c("location_name")) %>%
left_join(initialc_cmods, by="location_name") %>%
select(Exp_ID, location_name, treatment_number,treatment_name, year_name, lowest_depth, soil_depth,
soil_depth_min_cm, soil_depth_max_cm, combination_group,
soc_tha, initial_dataset, initial_dsm, initial_cmods, initial_soc_year) %>%
# Set the initial C to either be 1 year before the first year ever measured for that site, or 1999 (maximum start date).
group_by(Exp_ID, location_name) %>%
mutate(initial_soc_year_dsm = ifelse(min(year_name) < 2000, min(year_name)-1, 1999))
site_data_4_summed <- site_data_3_joined %>%
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name, initial_dataset, initial_dsm, initial_cmods, initial_soc_year, initial_soc_year_dsm, combination_group, lowest_depth) %>%
summarise(soc_tha_lowest_depth = sum(soc_tha)) %>%
# Get mean values for each combination group to remove duplicates
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name, initial_dataset, initial_dsm, initial_cmods, initial_soc_year, initial_soc_year_dsm, lowest_depth) %>%
summarise(across(c("soc_tha_lowest_depth"), mean))
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(max(cur_data()$lowest_depth) == 30 &
lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
)),
0)) %>%
# Perform corrections
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference + fifteen_to_thirty_average_additional,
soc_tha_lowest_depth + fifteen_to_thirty_average_additional)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
fifteenthirty <- site_data_3_joined %>%
select(-combination_group) %>%
filter(soil_depth == "15-30") %>%
unique() %>%
rename(id = Exp_ID,
loc = location_name,
year = year_name,
trmt = treatment_name)
site_data_5_corrected %>%
filter(location_name == "Swift Current New") %>%
mutate(soc_30cm_dynamic = soc_30cm_dynamic + fifteen_to_thirty_average_additional)
site_data_5_corrected %>%
select(Exp_ID, location_name, treatment_name, year_name,
initial_dsm,
soc_30cm_naive, soc_30cm_dynamic
) %>%
filter(location_name == "Lethbridge") %>%
filter(!is.na(soc_30cm_naive)) %>%
filter(treatment_name == "Fw-Wt I")
site_data_5_corrected %>%
select(Exp_ID, location_name, treatment_name, year_name,
initial_dsm, soc_tha_lowest_depth,
soc_30cm_naive, soc_30cm_dynamic
) %>%
filter(location_name == "Ellerslie") %>%
filter(!is.na(soc_30cm_naive)) %>%
filter(treatment_name == "F25NS")
site_data_5_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(location_name)) +
labs(x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
make_normal_plot <- function(location) {
site_data_5_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic", "soc_tha_lowest_depth"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive", "Uncorrected"), values = c("blue", "red", "#666666")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
}
make_normal_plot("Ellerslie")
make_normal_plot("Harrow")
make_normal_plot("Indian Head")
make_normal_plot("Lethbridge")
make_normal_plot("Ottawa")
make_normal_plot("Scott")
make_normal_plot("Swift Current New")
make_normal_plot("Swift Current Old")
library(ggplot2)
library(dplyr)
library(here)
library(stringr)
library(tidyr)
dir.create(tempdir()) #This fixes a bug if the temporary directory is not found
here::i_am("qc_initialc.rmd")
source(here("r/make_depth_groups.r"))
site_data_1_all <- readr::read_csv(here("data/lte_master_beta_dec02.csv")) %>%
mutate(soil_depth = paste0(soil_depth_min_cm,"-",soil_depth_max_cm))
initialc_dsm <- readr::read_csv(here("data/lte_soc_30_cm_dsm.csv")) %>%
mutate(location_name = location_n) %>%
select(location_name, initial_dsm = `Can_SOC30 (Mg ha-1)`) %>%
unique
initialc_cmods <- readr::read_csv(here("data/ExptSiteList.csv")) %>%
select(location_name, initial_cmods = init_soc) %>%
unique
site_data_2_depth_groups <- site_data_1_all %>%
full_join(initialc_dsm, by=c("location_name")) %>%
full_join(initialc_cmods, by="location_name") %>%
select(Exp_ID, location_name, treatment_number,treatment_name, year_name, replication_number, soil_depth, soil_depth_min_cm, soil_depth_max_cm,
initial_soc_year,
initial_dataset = initial_soc_tha,
soc_tha) %>%
filter(!is.na(soc_tha)) %>%
# Get the mean for field_name, replication_number, and block
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name, soil_depth_min_cm, soil_depth_max_cm, initial_soc_year) %>%
summarise(across(initial_dataset:soc_tha, mean)) %>%
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name) %>%
group_split() %>%
purrr::map(~make_depth_groups(.)) %>%
bind_rows
site_data_3_joined <- site_data_2_depth_groups %>%
left_join(initialc_dsm, by=c("location_name")) %>%
left_join(initialc_cmods, by="location_name") %>%
select(Exp_ID, location_name, treatment_number,treatment_name, year_name, lowest_depth, soil_depth,
soil_depth_min_cm, soil_depth_max_cm, combination_group,
soc_tha, initial_dataset, initial_dsm, initial_cmods, initial_soc_year) %>%
# Set the initial C to either be 1 year before the first year ever measured for that site, or 1999 (maximum start date).
group_by(Exp_ID, location_name) %>%
mutate(initial_soc_year_dsm = ifelse(min(year_name) < 2000, min(year_name)-1, 1999))
site_data_4_summed <- site_data_3_joined %>%
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name, initial_dataset, initial_dsm, initial_cmods, initial_soc_year, initial_soc_year_dsm, combination_group, lowest_depth) %>%
summarise(soc_tha_lowest_depth = sum(soc_tha)) %>%
# Get mean values for each combination group to remove duplicates
group_by(Exp_ID, location_name, year_name, treatment_number, treatment_name, initial_dataset, initial_dsm, initial_cmods, initial_soc_year, initial_soc_year_dsm, lowest_depth) %>%
summarise(across(c("soc_tha_lowest_depth"), mean))
site_data_5_corrected <- site_data_4_summed %>%
group_by(Exp_ID, location_name, treatment_number, treatment_name) %>%
# If we are missing the 15-30cm measurement, then calculate the average value of the 15-30cm of the points surrounding the gaps.
mutate(fifteen_to_thirty_average_additional = ifelse(max(cur_data()$lowest_depth) == 30 &
lowest_depth != max(cur_data()$lowest_depth),
mean(
c(
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year > year_name]))) %>%
pull(soc_tha),
fifteenthirty %>%
filter(id == Exp_ID,
trmt == treatment_name) %>%
filter(year == min(unique(year[year < year_name]))) %>%
pull(soc_tha)
)),
0)) %>%
# Perform corrections
mutate(first_soc_treatment = first(soc_tha_lowest_depth),
soc_dsm_difference = initial_dsm - first_soc_treatment,
lowest_depth_difference = 30 - lowest_depth,
soc_30cm_dynamic = ifelse(lowest_depth_difference != 0,
soc_tha_lowest_depth + soc_dsm_difference + fifteen_to_thirty_average_additional,
soc_tha_lowest_depth + fifteen_to_thirty_average_additional)) %>%
mutate(soc_30cm_naive = soc_tha_lowest_depth * (30/lowest_depth))
fifteenthirty <- site_data_3_joined %>%
select(-combination_group) %>%
filter(soil_depth == "15-30") %>%
unique() %>%
rename(id = Exp_ID,
loc = location_name,
year = year_name,
trmt = treatment_name)
site_data_5_corrected %>%
filter(location_name == "Swift Current New") %>%
mutate(soc_30cm_dynamic = soc_30cm_dynamic + fifteen_to_thirty_average_additional)
site_data_5_corrected %>%
select(Exp_ID, location_name, treatment_name, year_name,
initial_dsm,
soc_30cm_naive, soc_30cm_dynamic
) %>%
filter(location_name == "Lethbridge") %>%
filter(!is.na(soc_30cm_naive)) %>%
filter(treatment_name == "Fw-Wt I")
site_data_5_corrected %>%
select(Exp_ID, location_name, treatment_name, year_name,
initial_dsm, soc_tha_lowest_depth,
soc_30cm_naive, soc_30cm_dynamic
) %>%
filter(location_name == "Ellerslie") %>%
filter(!is.na(soc_30cm_naive)) %>%
filter(treatment_name == "F25NS")
site_data_5_corrected %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(location_name)) +
labs(x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive"), values = c("blue", "red")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
make_normal_plot <- function(location) {
site_data_5_corrected %>%
filter(location_name == location) %>%
pivot_longer(c("soc_30cm_naive", "soc_30cm_dynamic", "soc_tha_lowest_depth"), names_to="soc_method", values_to="soc") %>%
pivot_longer(c("initial_dsm", "initial_cmods"), names_to="initial_method", values_to="initial") %>%
ggplot(aes(x=year_name, y=soc_30cm_naive)) +
geom_point(aes(y=soc, color=soc_method), alpha=0.2) +
geom_point(aes(y=initial, shape=initial_method, x=initial_soc_year_dsm), color="green") +
theme_bw() +
facet_wrap(vars(treatment_name)) +
labs(title = location, x = "Year", y = "SOC (Mg/ha)",
color = "Depth \ncorrection \nmethod", shape = "Initial C \nestimation \nmethod") +
theme(aspect.ratio = 1) +
scale_color_manual(labels = c("Dynamic", "Naive", "Uncorrected"), values = c("blue", "red", "#666666")) +
scale_shape_manual(labels = c("CMods", "DSM"), values = c("square", "triangle"))
}
make_normal_plot("Ellerslie")
make_normal_plot("Harrow")
make_normal_plot("Indian Head")
make_normal_plot("Lethbridge")
make_normal_plot("Ottawa")
make_normal_plot("Scott")
make_normal_plot("Swift Current New")
make_normal_plot("Swift Current Old")
